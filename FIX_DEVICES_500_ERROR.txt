cd /var/www/ivr-platform/ivr_calling/backend
echo "=== COMPLETE SYSTEM ANALYSIS ==="
echo "1. Backend Status:"
pm2 status
echo ""
echo "2. Database Connection Test:"
node -e "
const { connectDB } = require('./src/config/database.js');
connectDB().then(() => {
  console.log('✅ Database connection successful');
  process.exit(0);
}).catch(err => {
  console.log('❌ Database connection failed:', err.message);
  process.exit(1);
});
"
echo ""
echo "3. Analytics API Direct Test:"
curl -s -w "\nStatus: %{http_code}\n" https://ivr.wxon.in/api/analytics/dashboard
echo ""
echo "4. Analytics Campaigns Test:"
curl -s -w "\nStatus: %{http_code}\n" https://ivr.wxon.in/api/analytics/campaigns
echo ""
echo "5. Analytics Calls Test:"
curl -s -w "\nStatus: %{http_code}\n" https://ivr.wxon.in/api/analytics/calls
echo ""
echo "6. Backend Logs (Last 10 lines):"
pm2 logs ivr-backend-8090 --lines 10 --nostream